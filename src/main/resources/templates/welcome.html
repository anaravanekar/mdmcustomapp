<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">

<head>
    <title>Accounts</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <link href="../../vendor/jQueryUI-1.12.1/themes/base/jquery-ui.min.css" rel="stylesheet" />
    <link rel="stylesheet" type="text/css" href="../../vendor/bootstrap/css/bootstrap.min.css" />
    <link rel="stylesheet" type="text/css" href="//cdn.datatables.net/1.10.16/css/jquery.dataTables.min.css" />
    <link rel="stylesheet" href="../../css/main.css" />
    <style type="text/css">
        .bs-example {
            margin: 20px;
        }
    </style>
</head>

<body>
<div id="acc-table" class="bs-example">
    <div class="table-responsive">
        <table id="accountTable" class="table table-striped table-hover">
            <thead>
            <th>
                Addresses
            </th>
            <th th:each="column: ${columnlist}" th:text="${column}"></th>
            </thead>
            <tbody>
            <tr th:each="item : ${resultList}">
                <td><span th:id="${item.get('MDMACCOUNTID')}" th:attr="data-window='info_window' + ${item.get('MDMACCOUNTID')},data-accname=${item.get('ACCOUNTNAME')}" class="addrlink glyphicon glyphicon-eject"></span></td>
                <td th:each="entry : ${item}"
                    th:text="${entry.value}"></td>
            </tr>
            </tbody>
        </table>
    </div>
</div>
<div th:id="'info_window' + ${item.get('MDMACCOUNTID')}" th:each="item : ${resultList}" style='display: none'>
    <b>Address</b>
</div>

<script type="text/javascript" src="../../vendor/jQuery-1.12.3/jquery-1.12.3.min.js"></script>
<script src="../../vendor/jQueryUI-1.12.1/jquery-ui.js"></script>
<script type="text/javascript" src="../../vendor/bootstrap/js/bootstrap.min.js"></script>
<script type="text/javascript" src="//cdn.datatables.net/1.10.16/js/jquery.dataTables.min.js"></script>
<script type="text/javascript" th:inline="javascript">
 /*<![CDATA[*/
        $(document).ready(function() {

                        /*$('.search-table').on('change', function(){
                            alert(this.value);
                            alert($(this).attr('id'));
                             var str = '';
                            $('.search-table').each(function(){
                                str = '&' + $(this).attr('id')+'='+ $(this).val();
                            });
                            alert(str);
                         });*/
                         $( "#searchTableForm" ).on( "submit", function( event ) {
                              event.preventDefault();
                              alert('form submitted');

                          });


            $("#accountTable").DataTable({
                ajax: {
                    url: '/accounts',
                    dataSrc: '',
                    data: function(data){
                        delete data.columns;
                    }
                },
                serverSide : true,
                searching: false,
                columns: [
                    {
                        "data": "ACCOUNTNAME"
                    },{
                        "data": "ACCOUNTNUMBER"
                    },
					{
                        "data": "MDMACCOUNTID"
                    },
					{
                        "data": "DAQAMETADATA_STATE"
                    },
                    {
                        "data": "DAQAMETADATA_CLUSTERID"
                    },
					{
                        "searchable": false,"data": "T_LAST_USER_ID",
                    },
                    {
                        "searchable": false,"data": "T_CREATOR_ID"
                    },
                    {
                        "searchable": false,"searchable": false,"data": "T_CREATION_DATE"
                    },
                    {
                        "searchable": false,"data": "T_LAST_WRITE"
                    },
                    {
                        "searchable": false,"data": "DAQAMETADATA_SCORE"
                    },
                    {
                        "searchable": false,"data": "DAQAMETADATAEFIRSTMATCHING"
                    },
                    {
                        "searchable": false,"data": "DAQAMETADATASECONDMATCHING"
                    },
                    {
                        "searchable": false,"data": "DAQAMETADATAEMATCHINGSCORE"
                    },
                    {
                        "searchable": false,"data": "DAQAMETADATA_TARGETRECORD_"
                    },
                    {
                        "searchable": false,"data": "DAQAMETADATA_MERGEORIGIN"
                    },
                    {
                        "searchable": false,"data": "DAQAMETADATA_TIMESTAMP"
                    },
                    {
                        "searchable": false,"data": "DAQAMETADATA_WASGOLDEN"
                    },
                    {
                        "searchable": false,"data": "DAQAMETADATA_AUTOCREATED"
                    },
                    {
                        "searchable": false,"data": "DAQAMETADATAFIELDSMATCHING"
                    },
                    {
                        "searchable": false,"data": "DAQAMETADATAATONCE_GROUPED"
                    },
                    {
                        "searchable": false,"data": "DAQAMETADATACE_CLUSTERSIZE"
                    },
                    {
                        "searchable": false,"data": "DAQAMETADATA_WORKFLOW_UUID"
                    },
                    {
                        "searchable": false,"data": "DAQAMETADATA_WORKFLOW_NAME"
                    },
                    {
                        "searchable": false,"data": "DAQAMETADATAFLOW_TIMESTAMP"
                    },
                    {
                        "searchable": false,"data": "DAQAMETADATA_WORKFLOW_USER"
                    },
                    {
                        "searchable": false,"data": "DAQAMETADATACESSPOLICYCODE"
                    },
                    {
                        "searchable": false,"data": "DAQAMETADATAHINGPOLICYCODE"
                    },
                    {
                        "searchable": false,"data": "DAQAMETADATASHIPPOLICYCODE"
                    },
                    {
                        "searchable": false,"data": "DAQAMETADATA_OPERATIONCODE"
                    },
                    {
                        "searchable": false,"data": "DAQAMETADATATOPERATIONCODE"
                    },
                    {
                        "searchable": false,"data": "DAQAMETADATAHOPERATIONCODE"
                    },
                    {
                        "searchable": false,"data": "DAQAMETADATACLEANSINGSTATE"
                    },
                    {
                        "searchable": false,"data": "DAQAMETADATAGPROCEDURECODE"
                    },
                    {
                        "searchable": false,"data": "DAQAMETADATANSINGOPERATION"
                    },
                    {
                        "searchable": false,"data": "DAQAMETADATA_EXECUTIONDATE"
                    },
                    {
                        "searchable": false,"data": "DAQAMETADATAGMETADATA_USER"
                    },
                    {
                        "searchable": false,"data": "DAQAMETADATAMETADATA_FIELD"
                    },
                    {
                        "searchable": false,"data": "DAQAMETADATA_QUALITYDEFECT"
                    },
                    {
                        "searchable": false,"data": "STATUS"
                    },
                    {
                        "searchable": false,"data": "SYSTEMID"
                    },
                    {
                        "searchable": false,"data": "SYSTEMNAME"
                    },
                    {
                        "searchable": false,"data": "CUSTOMERTYPE"
                    },
                    {
                        "searchable": false,"data": "REGISTRYID"
                    },
                    {
                        "searchable": false,"data": "ALIAS"
                    },
                    {
                        "searchable": false,"data": "NAMEPRONUNCIATION"
                    },
                    {
                        "searchable": false,"data": "TAXPAYERID"
                    },
                    {
                        "searchable": false,"data": "TAXREGISTRATIONNUMBER"
                    },
                    {
                        "searchable": false,"data": "CUSTOMERCATEGORY"
                    },
                    {
                        "searchable": false,"data": "ACCOUNTDESCRIPTION"
                    },
                    {
                        "searchable": false,"data": "REGION"
                    },
                    {
                        "searchable": false,"data": "CLASSIFICATION"
                    },
                    {
                        "searchable": false,"data": "ACCOUNTTYPE"
                    },
                    {
                        "searchable": false,"data": "SALESCHANNEL"
                    },
                    {
                        "searchable": false,"data": "REFERENCE"
                    },
                    {
                        "searchable": false,"data": "NLSLANGUAGECODE"
                    },
                    {
                        "searchable": false,"data": "NAMELOCALLANGUAGE"
                    },
                    {
                        "searchable": false,"data": "CUSTOMERSCREENING"
                    },
                    {
                        "searchable": false,"data": "LASTCREDITREVIEWDATE"
                    },
                    {
                        "searchable": false,"data": "NEXTCREDITREVIEWDATE"
                    },
                    {
                        "searchable": false,"data": "CREDITREVIEWCYCLE"
                    },
                    {
                        "searchable": false,"data": "PARENTPARTY"
                    },
                    {
                        "searchable": false,"data": "EMGLASTTRANS"
                    },
                    {
                        "searchable": false,"data": "GROUPINGDESCRIPTION"
                    },
                    {
                        "searchable": false,"data": "GROUPINGID"
                    },
                    {
                        "searchable": false,"data": "IXIACLASSIFICATION"
                    },
                    {
                        "searchable": false,"data": "PROFILECLASS"
                    }
                ]
            });


            $(".addrlink").click(function(e) {
                //alert("button clicked");
                var accId = $(this).attr('id');
                var title = "Account: " + $(this).data('accname');
                var windowElem = $(this).data('window');
                $.ajax({
                    url: "/account/" + accId + "/address",
                    success: function(data) {
                        $("#" + windowElem).html(data);
                    }
                });
                //$("#" + windowElem).html($("#acc-table").html());
                $("#" + windowElem).dialog({
                    height: 'auto',
                    maxHeight: 750,
                    width: 750,
                    title: title
                });
            });
        });
 /*]]>*/
    </script>
</body>

</html>